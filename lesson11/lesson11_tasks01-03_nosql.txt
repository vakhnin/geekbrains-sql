/* Практическое задание #11 
 * "NoSQL". 
 */

/* Задание # 1.
 * В базе данных Redis подберите коллекцию для подсчета посещений с определенных IP-адресов.
*/

/* Для задачи подходит формат hash
 * Обращение по IP регистрируем командой HINCRBY
 * При первом обращение счетчик устанавливается в 1
 * При следующих увеличивается на 1
 */
127.0.0.1:6379> HINCRBY ips 192.168.0.1 1
(integer) 1
127.0.0.1:6379> HINCRBY ips 192.168.0.1 1
(integer) 2
127.0.0.1:6379> HINCRBY ips 192.168.0.1 1
(integer) 3
127.0.0.1:6379> HINCRBY ips 192.168.0.2 1
(integer) 1
127.0.0.1:6379> HINCRBY ips 192.168.0.3 1
(integer) 1
-- Получение обращений со всех IP
127.0.0.1:6379> HGETALL ips
1) "192.168.0.1"
2) "3"
3) "192.168.0.2"
4) "1"
5) "192.168.0.3"
6) "1"
-- Получение обращений только с IP из списка
127.0.0.1:6379> HMGET ips 192.168.0.1  192.168.0.2
1) "3"
2) "1"
127.0.0.1:6379> TYPE ips
hash



/* Задание # 2.
 * При помощи базы данных Redis решите задачу поиска имени пользователя по электронному адресу и наоборот, 
 * поиск электронного адреса пользователя по его имени.
*/

-- Заполняем данными
127.0.0.1:6379> HMSET user_name_1:mail1@gb.com user_name_1 mail1@gb.com
OK
127.0.0.1:6379> HMSET user_name_2:mail2@gb.com user_name_2 mail2@gb.com
OK
127.0.0.1:6379> HMSET user_name_3:mail3@gb.com user_name_3 mail3@gb.com
OK
-- Ищем пользователя по e-mail
127.0.0.1:6379> KEYS *:mail2@gb.com
1) "user_name_2:mail2@gb.com"
-- Ищем e-mail по имени пользователя
127.0.0.1:6379> KEYS user_name_3:*
1) "user_name_3:mail3@gb.com"